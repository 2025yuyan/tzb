import{r as a,c as s,w as e,i as l,o as t,b as i,x as o,d as n,e as c,E as u,f as d,G as r,t as f,m,s as p,H as g,J as v,g as _,j as b}from"./index-C11iUV34.js";import{r as k}from"./request.DLnpqrrV.js";import{_ as h}from"./_plugin-vue_export-helper.BCo6x5W8.js";const x=h({__name:"index",setup(h){const x=a(""),y=a(""),C=a(!1),j=a("");function T(){p({title:"语音输入功能待接入",icon:"none"})}function q(){g({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:a=>{j.value=a.tempFilePaths[0]}})}function w(){v({urls:[j.value]})}function V(){b({url:"/pages/medication/reminder"})}function z(){if(!x.value.trim()&&!j.value)return void p({title:"请填写症状或添加图片",icon:"none"});C.value=!0;const a=_("token");console.log("准备发送诊断请求..."),k({url:"/ai/diagnosis",method:"POST",header:{Authorization:"Bearer "+a,"Content-Type":"application/json"},data:{symptoms:x.value,imageUrl:j.value}}).then(a=>{console.log("请求成功:",a),y.value=a.diagnosis||"未获取到诊断建议",C.value=!1}).catch(a=>{console.error("请求失败:",a),p({title:"请求失败",icon:"none"}),C.value=!1})}return(a,p)=>{const g=n,v=u,_=d,b=l,k=r;return t(),s(b,{class:"diagnosis-bg"},{default:e(()=>[i(b,{class:"diagnosis-card"},{default:e(()=>[i(g,{class:"diagnosis-label"},{default:e(()=>[c("请描述您的症状：")]),_:1}),i(g,{class:"diagnosis-tip"},{default:e(()=>[c("可手写输入或语音描述您的身体状况")]),_:1}),i(v,{modelValue:x.value,"onUpdate:modelValue":p[0]||(p[0]=a=>x.value=a),class:"diagnosis-input",placeholder:"如：头晕、咳嗽、血压高...",rows:"4"},null,8,["modelValue"]),i(b,{class:"diagnosis-actions"},{default:e(()=>[i(_,{class:"voice-btn",onClick:T},{default:e(()=>[i(g,{class:"fas fa-microphone"}),c(" 语音输入 ")]),_:1}),i(_,{class:"img-btn",onClick:q},{default:e(()=>[i(g,{class:"fas fa-image"}),c(" 添加图片 ")]),_:1})]),_:1}),j.value?(t(),s(b,{key:0,class:"img-preview",onClick:w},{default:e(()=>[i(k,{src:j.value,mode:"aspectFit",class:"img-thumb"},null,8,["src"])]),_:1})):o("",!0),i(_,{class:"diagnosis-btn",onClick:z,disabled:C.value},{default:e(()=>[c(f(C.value?"诊断中...":"提交诊断"),1)]),_:1},8,["disabled"]),i(b,{class:"quick-actions"},{default:e(()=>[m("p",{class:"tixing"},"你可能需要："),i(_,{class:"quick-action-btn",onClick:V},{default:e(()=>[i(g,{class:"fas fa-pills"}),c(" 服药提醒设置 ")]),_:1})]),_:1}),y.value?(t(),s(b,{key:1,class:"diagnosis-result"},{default:e(()=>[i(g,{class:"result-title"},{default:e(()=>[c("诊断建议：")]),_:1}),i(g,{class:"result-content"},{default:e(()=>[c(f(y.value),1)]),_:1})]),_:1})):o("",!0)]),_:1})]),_:1})}}},[["__scopeId","data-v-65a663d0"]]);export{x as default};
