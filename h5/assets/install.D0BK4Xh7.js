import{P as e,D as t,r as a,f as n,g as i,S as r,h as l,l as o,j as s,m as g,p as u,n as c,k as h,o as d,q as f,s as p,t as y,v,w as m,_ as b,x,y as A,z as M,C as w,Z as S,A as L,B as T,F as D,G as N,H as I,I as P,J as C,K as _,L as G,M as E,N as O,O as k,Q as R,R as W,T as V,U as B,V as z}from"./index.C10DMPZc.js";function U(e,t,a,n,i,r,l,o){var s=i-e,g=r-t,u=a-e,c=n-t,h=Math.sqrt(u*u+c*c),d=(s*(u/=h)+g*(c/=h))/h;d*=h;var f=l[0]=e+d*u,p=l[1]=t+d*c;return Math.sqrt((f-i)*(f-i)+(p-r)*(p-r))}var q=new e,Y=new e,F=new e,H=new e,X=new e,Z=[],j=new e;function J(t,a){if(a<=180&&a>0){a=a/180*Math.PI,q.fromArray(t[0]),Y.fromArray(t[1]),F.fromArray(t[2]),e.sub(H,q,Y),e.sub(X,F,Y);var n=H.len(),i=X.len();if(!(n<.001||i<.001)){H.scale(1/n),X.scale(1/i);var r=H.dot(X);if(Math.cos(a)<r){var l=U(Y.x,Y.y,F.x,F.y,q.x,q.y,Z);j.fromArray(Z),j.scaleAndAdd(X,l/Math.tan(Math.PI-a));var o=F.x!==Y.x?(j.x-Y.x)/(F.x-Y.x):(j.y-Y.y)/(F.y-Y.y);if(isNaN(o))return;o<0?e.copy(j,Y):o>1&&e.copy(j,F),j.toArray(t[1])}}}}function K(t,a,n){if(n<=180&&n>0){n=n/180*Math.PI,q.fromArray(t[0]),Y.fromArray(t[1]),F.fromArray(t[2]),e.sub(H,Y,q),e.sub(X,F,Y);var i=H.len(),r=X.len();if(!(i<.001||r<.001))if(H.scale(1/i),X.scale(1/r),H.dot(a)<Math.cos(n)){var l=U(Y.x,Y.y,F.x,F.y,q.x,q.y,Z);j.fromArray(Z);var o=Math.PI/2,s=o+Math.acos(X.dot(a))-n;if(s>=o)e.copy(j,F);else{j.scaleAndAdd(X,l/Math.tan(Math.PI/2-s));var g=F.x!==Y.x?(j.x-Y.x)/(F.x-Y.x):(j.y-Y.y)/(F.y-Y.y);if(isNaN(g))return;g<0?e.copy(j,Y):g>1&&e.copy(j,F)}j.toArray(t[1])}}}function Q(e,t,a,n){var i="normal"===a,r=i?e:e.ensureState(a);r.ignore=t;var l=n.get("smooth");l&&!0===l&&(l=.3),r.shape=r.shape||{},l>0&&(r.shape.smooth=l);var o=n.getModel("lineStyle").getLineStyle();i?e.useStyle(o):r.style=o}function $(e,t){var a=t.smooth,n=t.points;if(n)if(e.moveTo(n[0][0],n[0][1]),a>0&&n.length>=3){var i=l(n[0],n[1]),r=l(n[1],n[2]);if(!i||!r)return e.lineTo(n[1][0],n[1][1]),void e.lineTo(n[2][0],n[2][1]);var s=Math.min(i,r)*a,g=o([],n[1],n[0],s/i),u=o([],n[1],n[2],s/r),c=o([],g,u,.5);e.bezierCurveTo(g[0],g[1],g[0],g[1],c[0],c[1]),e.bezierCurveTo(u[0],u[1],u[0],u[1],n[2][0],n[2][1])}else for(var h=1;h<n.length;h++)e.lineTo(n[h][0],n[h][1])}function ee(e,t,a){var n=e.get("borderRadius");if(null==n)return a?{cornerRadius:0}:null;s(n)||(n=[n,n,n,n]);var i=Math.abs(t.r||0-t.r0||0);return{cornerRadius:g(n,function(e){return u(e,i)})}}var te=2*Math.PI,ae=Math.PI/180;function ne(e,t){return f(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function ie(e,t){var a=ne(e,t),n=e.get("center"),i=e.get("radius");s(i)||(i=[0,i]);var r,l,o=p(a.width,t.getWidth()),g=p(a.height,t.getHeight()),u=Math.min(o,g),c=p(i[0],u/2),h=p(i[1],u/2),d=e.coordinateSystem;if(d){var f=d.dataToPoint(n);r=f[0]||0,l=f[1]||0}else s(n)||(n=[n,n]),r=p(n[0],o)+a.x,l=p(n[1],g)+a.y;return{cx:r,cy:l,r0:c,r:h}}function re(e,t,a){t.eachSeriesByType(e,function(e){var t=e.getData(),n=t.mapDimension("value"),i=ne(e,a),r=ie(e,a),l=r.cx,o=r.cy,s=r.r,g=r.r0,u=-e.get("startAngle")*ae,h=e.get("endAngle"),f=e.get("padAngle")*ae;h="auto"===h?u-te:-h*ae;var p=e.get("minAngle")*ae+f,y=0;t.each(n,function(e){!isNaN(e)&&y++});var v=t.getSum(n),m=Math.PI/(v||y)*2,b=e.get("clockwise"),x=e.get("roseType"),A=e.get("stillShowZeroSum"),M=t.getDataExtent(n);M[0]=0;var w=b?1:-1,S=[u,h],L=w*f/2;c(S,!b),u=S[0],h=S[1];var T=le(e);T.startAngle=u,T.endAngle=h,T.clockwise=b;var D=Math.abs(h-u),N=D,I=0,P=u;if(t.setLayout({viewRect:i,r:s}),t.each(n,function(e,a){var n;if(isNaN(e))t.setItemLayout(a,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:b,cx:l,cy:o,r0:g,r:x?NaN:s});else{(n="area"!==x?0===v&&A?m:e*m:D/y)<p?(n=p,N-=p):I+=e;var i=P+w*n,r=0,u=0;f>n?u=r=P+w*n/2:(r=P+L,u=i-L),t.setItemLayout(a,{angle:n,startAngle:r,endAngle:u,clockwise:b,cx:l,cy:o,r0:g,r:x?d(e,M,[g,s]):s}),P=i}}),N<te&&y)if(N<=.001){var C=D/y;t.each(n,function(e,a){if(!isNaN(e)){var n=t.getItemLayout(a);n.angle=C;var i=0,r=0;C<f?r=i=u+w*(a+.5)*C:(i=u+w*a*C+L,r=u+w*(a+1)*C-L),n.startAngle=i,n.endAngle=r}})}else m=N/I,P=u,t.each(n,function(e,a){if(!isNaN(e)){var n=t.getItemLayout(a),i=n.angle===p?p:e*m,r=0,l=0;i<f?l=r=P+w*i/2:(r=P+L,l=P+w*i-L),n.startAngle=r,n.endAngle=l,P+=w*i}})})}var le=h();var oe=Math.PI/180;function se(e,t,a,n,i,r,l,o,s,g){if(!(e.length<2)){for(var u=e.length,c=0;c<u;c++)if("outer"===e[c].position&&"labelLine"===e[c].labelAlignTo){var h=e[c].label.x-g;e[c].linePoints[1][0]+=h,e[c].label.x=g}m(e,s,s+l)&&function(e){for(var r={list:[],maxY:0},l={list:[],maxY:0},o=0;o<e.length;o++)if("none"===e[o].labelAlignTo){var s=e[o],g=s.label.y>a?l:r,u=Math.abs(s.label.y-a);if(u>=g.maxY){var c=s.label.x-t-s.len2*i,h=n+s.len,f=Math.abs(c)<h?Math.sqrt(u*u/(1-c*c/h/h)):h;g.rB=f,g.maxY=u}g.list.push(s)}d(r),d(l)}(e)}function d(e){for(var r=e.rB,l=r*r,o=0;o<e.list.length;o++){var s=e.list[o],g=Math.abs(s.label.y-a),u=n+s.len,c=u*u,h=Math.sqrt(Math.abs((1-g*g/l)*c)),d=t+(h+s.len2)*i,f=d-s.label.x;ge(s,s.targetTextWidth-f*i,!0),s.label.x=d}}}function ge(e,t,a){if(void 0===a&&(a=!1),null==e.labelStyleWidth){var n=e.label,i=n.style,r=e.rect,l=i.backgroundColor,o=i.padding,s=o?o[1]+o[3]:0,g=i.overflow,u=r.width+(l?0:s);if(t<u||a){var c=r.height;if(g&&g.match("break")){n.setStyle("backgroundColor",null),n.setStyle("width",t-s);var h=n.getBoundingRect();n.setStyle("width",Math.ceil(h.width)),n.setStyle("backgroundColor",l)}else{var d=t-s,f=t<u?d:a?d>e.unconstrainedWidth?null:d:null;n.setStyle("width",f)}var p=n.getBoundingRect();r.width=p.width;var y=(n.style.margin||0)+2.1;r.height=p.height+y,r.y-=(r.height-c)/2}}}function ue(e){return"center"===e.position}function ce(t){var a,n,i=t.getData(),r=[],l=!1,o=(t.get("minShowLabelAngle")||0)*oe,s=i.getLayout("viewRect"),g=i.getLayout("r"),u=s.width,c=s.x,h=s.y,d=s.height;function f(e){e.ignore=!0}i.each(function(t){var s=i.getItemGraphicEl(t),h=s.shape,d=s.getTextContent(),m=s.getTextGuideLine(),b=i.getItemModel(t),x=b.getModel("label"),A=x.get("position")||b.get(["emphasis","label","position"]),M=x.get("distanceToLabelLine"),w=x.get("alignTo"),S=p(x.get("edgeDistance"),u),L=x.get("bleedMargin"),T=b.getModel("labelLine"),D=T.get("length");D=p(D,u);var N=T.get("length2");if(N=p(N,u),Math.abs(h.endAngle-h.startAngle)<o)return y(d.states,f),d.ignore=!0,void(m&&(y(m.states,f),m.ignore=!0));if(function(e){if(!e.ignore)return!0;for(var t in e.states)if(!1===e.states[t].ignore)return!0;return!1}(d)){var I,P,C,_,G=(h.startAngle+h.endAngle)/2,E=Math.cos(G),O=Math.sin(G);a=h.cx,n=h.cy;var k="inside"===A||"inner"===A;if("center"===A)I=h.cx,P=h.cy,_="center";else{var R=(k?(h.r+h.r0)/2*E:h.r*E)+a,W=(k?(h.r+h.r0)/2*O:h.r*O)+n;if(I=R+3*E,P=W+3*O,!k){var V=R+E*(D+g-h.r),B=W+O*(D+g-h.r),z=V+(E<0?-1:1)*N;I="edge"===w?E<0?c+S:c+u-S:z+(E<0?-M:M),P=B,C=[[R,W],[V,B],[z,B]]}_=k?"center":"edge"===w?E>0?"right":"left":E>0?"left":"right"}var U=Math.PI,q=0,Y=x.get("rotate");if(v(Y))q=Y*(U/180);else if("center"===A)q=0;else if("radial"===Y||!0===Y){q=E<0?-G+U:-G}else if("tangential"===Y&&"outside"!==A&&"outer"!==A){var F=Math.atan2(E,O);F<0&&(F=2*U+F),O>0&&(F=U+F),q=F-U}if(l=!!q,d.x=I,d.y=P,d.rotation=q,d.setStyle({verticalAlign:"middle"}),k){d.setStyle({align:_});var H=d.states.select;H&&(H.x+=d.x,H.y+=d.y)}else{var X=d.getBoundingRect().clone();X.applyTransform(d.getComputedTransform());var Z=(d.style.margin||0)+2.1;X.y-=Z/2,X.height+=Z,r.push({label:d,labelLine:m,position:A,len:D,len2:N,minTurnAngle:T.get("minTurnAngle"),maxSurfaceAngle:T.get("maxSurfaceAngle"),surfaceNormal:new e(E,O),linePoints:C,textAlign:_,labelDistance:M,labelAlignTo:w,edgeDistance:S,bleedMargin:L,rect:X,unconstrainedWidth:X.width,labelStyleWidth:d.style.width})}s.setTextConfig({inside:k})}}),!l&&t.get("avoidLabelOverlap")&&function(e,t,a,n,i,r,l,o){for(var s=[],g=[],u=Number.MAX_VALUE,c=-Number.MAX_VALUE,h=0;h<e.length;h++){var d=e[h].label;ue(e[h])||(d.x<t?(u=Math.min(u,d.x),s.push(e[h])):(c=Math.max(c,d.x),g.push(e[h])))}for(h=0;h<e.length;h++)if(!ue(y=e[h])&&y.linePoints){if(null!=y.labelStyleWidth)continue;d=y.label;var f=y.linePoints,p=void 0;p="edge"===y.labelAlignTo?d.x<t?f[2][0]-y.labelDistance-l-y.edgeDistance:l+i-y.edgeDistance-f[2][0]-y.labelDistance:"labelLine"===y.labelAlignTo?d.x<t?u-l-y.bleedMargin:l+i-c-y.bleedMargin:d.x<t?d.x-l-y.bleedMargin:l+i-d.x-y.bleedMargin,y.targetTextWidth=p,ge(y,p)}for(se(g,t,a,n,1,0,r,0,o,c),se(s,t,a,n,-1,0,r,0,o,u),h=0;h<e.length;h++){var y;if(!ue(y=e[h])&&y.linePoints){d=y.label,f=y.linePoints;var v="edge"===y.labelAlignTo,m=d.style.padding,b=m?m[1]+m[3]:0,x=d.style.backgroundColor?0:b,A=y.rect.width+x,M=f[1][0]-f[2][0];v?d.x<t?f[2][0]=l+y.edgeDistance+A+y.labelDistance:f[2][0]=l+i-y.edgeDistance-A-y.labelDistance:(d.x<t?f[2][0]=d.x+y.labelDistance:f[2][0]=d.x-y.labelDistance,f[1][0]=f[2][0]+M),f[1][1]=f[2][1]=d.y}}}(r,a,n,g,u,d,c,h);for(var m=0;m<r.length;m++){var b=r[m],x=b.label,A=b.labelLine,M=isNaN(x.x)||isNaN(x.y);if(x){x.setStyle({align:b.textAlign}),M&&(y(x.states,f),x.ignore=!0);var w=x.states.select;w&&(w.x+=x.x,w.y+=x.y)}if(A){var S=b.linePoints;M||!S?(y(A.states,f),A.ignore=!0):(J(S,b.minTurnAngle),K(S,b.surfaceNormal,b.maxSurfaceAngle),A.setShape({points:S}),x.__hostTarget.textGuideLineConfig={anchor:new e(S[0][0],S[0][1])})}}}var he=function(e){function l(t,a,n){var i=e.call(this)||this;i.z2=2;var r=new S;return i.setTextContent(r),i.updateData(t,a,n,!0),i}return b(l,e),l.prototype.updateData=function(e,t,a,n){var i=this,r=e.hostModel,l=e.getItemModel(t),o=l.getModel("emphasis"),s=e.getItemLayout(t),g=A(ee(l.getModel("itemStyle"),s,!0),s);if(isNaN(g.startAngle))i.setShape(g);else{if(n){i.setShape(g);var u=r.getShallow("animationType");r.ecModel.ssr?(L(i,{scaleX:0,scaleY:0},r,{dataIndex:t,isFrom:!0}),i.originX=g.cx,i.originY=g.cy):"scale"===u?(i.shape.r=s.r0,L(i,{shape:{r:s.r}},r,t)):null!=a?(i.setShape({startAngle:a,endAngle:a}),L(i,{shape:{startAngle:s.startAngle,endAngle:s.endAngle}},r,t)):(i.shape.endAngle=s.startAngle,T(i,{shape:{endAngle:s.endAngle}},r,t))}else D(i),T(i,{shape:g},r,t);i.useStyle(e.getItemVisual(t,"style")),N(i,l);var c=(s.startAngle+s.endAngle)/2,h=r.get("selectedOffset"),d=Math.cos(c)*h,f=Math.sin(c)*h,p=l.getShallow("cursor");p&&i.attr("cursor",p),this._updateLabel(r,e,t),i.ensureState("emphasis").shape=A({r:s.r+(o.get("scale")&&o.get("scaleSize")||0)},ee(o.getModel("itemStyle"),s)),A(i.ensureState("select"),{x:d,y:f,shape:ee(l.getModel(["select","itemStyle"]),s)}),A(i.ensureState("blur"),{shape:ee(l.getModel(["blur","itemStyle"]),s)});var y=i.getTextGuideLine(),v=i.getTextContent();y&&A(y.ensureState("select"),{x:d,y:f}),A(v.ensureState("select"),{x:d,y:f}),I(this,o.get("focus"),o.get("blurScope"),o.get("disabled"))}},l.prototype._updateLabel=function(e,l,o){var s=this,g=l.getItemModel(o),u=g.getModel("labelLine"),c=l.getItemVisual(o,"style"),h=c&&c.fill,d=c&&c.opacity;P(s,C(g),{labelFetcher:l.hostModel,labelDataIndex:o,inheritColor:h,defaultOpacity:d,defaultText:e.getFormattedLabel(o,"normal")||l.getName(o)});var f=s.getTextContent();s.setTextConfig({position:null,rotation:null}),f.attr({z2:10});var p=e.get(["label","position"]);if("outside"!==p&&"outer"!==p)s.removeTextGuideLine();else{var y=this.getTextGuideLine();y||(y=new n,this.setTextGuideLine(y)),function(e,r,l){var o=e.getTextGuideLine(),s=e.getTextContent();if(s){for(var g=r.normal,u=g.get("show"),c=s.ignore,h=0;h<t.length;h++){var d=t[h],f=r[d],p="normal"===d;if(f){var y=f.get("show");if((p?c:a(s.states[d]&&s.states[d].ignore,c))||!a(y,u)){var v=p?o:o&&o.states[d];v&&(v.ignore=!0),o&&Q(o,!0,d,f);continue}o||(o=new n,e.setTextGuideLine(o),p||!c&&u||Q(o,!0,"normal",r.normal),e.stateProxy&&(o.stateProxy=e.stateProxy)),Q(o,!1,d,f)}}if(o){i(o.style,l),o.style.fill=null;var m=g.get("showAbove");(e.textGuideLineConfig=e.textGuideLineConfig||{}).showAbove=m||!1,o.buildPath=$}}else o&&e.removeTextGuideLine()}(this,function(e,t){t=t||"labelLine";for(var a={normal:e.getModel(t)},n=0;n<r.length;n++){var i=r[n];a[i]=e.getModel([i,t])}return a}(g),{stroke:h,opacity:_(u.get(["lineStyle","opacity"]),d,1)})}},l}(x),de=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ignoreLabelLineUpdate=!0,t}return b(t,e),t.prototype.render=function(e,t,a,n){var i,r=e.getData(),l=this._data,o=this.group;if(!l&&r.count()>0){for(var s=r.getItemLayout(0),g=1;isNaN(s&&s.startAngle)&&g<r.count();++g)s=r.getItemLayout(g);s&&(i=s.startAngle)}if(this._emptyCircleSector&&o.remove(this._emptyCircleSector),0===r.count()&&e.get("showEmptyCircle")){var u=le(e),c=new x({shape:A(ie(e,a),u)});c.useStyle(e.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=c,o.add(c)}r.diff(l).add(function(e){var t=new he(r,e,i);r.setItemGraphicEl(e,t),o.add(t)}).update(function(e,t){var a=l.getItemGraphicEl(t);a.updateData(r,e,i),a.off("click"),o.add(a),r.setItemGraphicEl(e,a)}).remove(function(t){var a=l.getItemGraphicEl(t);M(a,e,t)}).execute(),ce(e),"expansion"!==e.get("animationTypeUpdate")&&(this._data=r)},t.prototype.dispose=function(){},t.prototype.containPoint=function(e,t){var a=t.getData().getItemLayout(0);if(a){var n=e[0]-a.cx,i=e[1]-a.cy,r=Math.sqrt(n*n+i*i);return r<=a.r&&r>=a.r0}},t.type="pie",t}(w);var fe=function(){function e(e,t){this._getDataWithEncodedVisual=e,this._getRawData=t}return e.prototype.getAllNames=function(){var e=this._getRawData();return e.mapArray(e.getName)},e.prototype.containName=function(e){return this._getRawData().indexOfName(e)>=0},e.prototype.indexOfName=function(e){return this._getDataWithEncodedVisual().indexOfName(e)},e.prototype.getItemVisual=function(e,t){return this._getDataWithEncodedVisual().getItemVisual(e,t)},e}(),pe=h(),ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.init=function(t){e.prototype.init.apply(this,arguments),this.legendVisualProvider=new fe(O(this.getData,this),O(this.getRawData,this)),this._defaultLabelLine(t)},t.prototype.mergeOption=function(){e.prototype.mergeOption.apply(this,arguments)},t.prototype.getInitialData=function(){return function(e,t,a){t=s(t)&&{coordDimensions:t}||A({encodeDefine:e.getEncode()},t);var n=e.getSource(),i=G(n,t).dimensions,r=new E(i,e);return r.initData(n,a),r}(this,{coordDimensions:["value"],encodeDefaulter:k(R,this)})},t.prototype.getDataParams=function(t){var a=this.getData(),n=pe(a),i=n.seats;if(!i){var r=[];a.each(a.mapDimension("value"),function(e){r.push(e)}),i=n.seats=W(r,a.hostModel.get("percentPrecision"))}var l=e.prototype.getDataParams.call(this,t);return l.percent=i[t]||0,l.$vars.push("percent"),l},t.prototype._defaultLabelLine=function(e){V(e,"labelLine",["show"]);var t=e.labelLine,a=e.emphasis.labelLine;t.show=t.show&&e.label.show,a.show=a.show&&e.emphasis.label.show},t.type="series.pie",t.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,endAngle:"auto",padAngle:0,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},t}(B);function ve(e){e.registerChartView(de),e.registerSeriesModel(ye),z("pie",e.registerAction),e.registerLayout(k(re,"pie")),e.registerProcessor({seriesType:"pie",reset:function(e,t){var a=t.findComponents({mainType:"legend"});if(a&&a.length){var n=e.getData();n.filterSelf(function(e){for(var t=n.getName(e),i=0;i<a.length;i++)if(!a[i].isSelected(t))return!1;return!0})}}}),e.registerProcessor(function(e){return{seriesType:e,reset:function(e,t){var a=e.getData();a.filterSelf(function(e){var t=a.mapDimension("value"),n=a.get(t,e);return!(v(n)&&!isNaN(n)&&n<0)})}}}("pie"))}export{ve as i};
