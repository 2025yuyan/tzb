import{r as a,d as s,w as e,e as l,o as t,f as o,z as i,h as n,j as u,S as c,k as d,T as r,t as f,s as m,U as p,V as v,b as g,C as _}from"./index-D-fdWgRi.js";import{_ as b}from"./_plugin-vue_export-helper.BCo6x5W8.js";const h=b({__name:"index",setup(b){const h=a(""),k=a(""),y=a(!1),C=a("");function w(){m({title:"语音输入功能待接入",icon:"none"})}function x(){p({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:a=>{C.value=a.tempFilePaths[0]}})}function z(){v({urls:[C.value]})}function T(){if(!h.value.trim()&&!C.value)return void m({title:"请填写症状或添加图片",icon:"none"});y.value=!0;const a=g("token");console.log("准备发送诊断请求..."),_({url:"https://tzb-two.vercel.app/api/ai/diagnosis",method:"POST",data:{symptoms:h.value,imageUrl:C.value},header:{Authorization:"Bearer "+a},success:a=>{console.log("请求成功:",a.data),k.value=a.data.diagnosis||"未获取到诊断建议",y.value=!1},fail:a=>{console.error("请求失败:",a),m({title:"请求失败",icon:"none"}),y.value=!1}})}return(a,m)=>{const p=n,v=c,g=d,_=l,b=r;return t(),s(_,{class:"diagnosis-bg"},{default:e(()=>[o(_,{class:"diagnosis-card"},{default:e(()=>[o(p,{class:"diagnosis-label"},{default:e(()=>[u("请描述您的症状：")]),_:1}),o(p,{class:"diagnosis-tip"},{default:e(()=>[u("可手写输入或语音描述您的身体状况")]),_:1}),o(v,{modelValue:h.value,"onUpdate:modelValue":m[0]||(m[0]=a=>h.value=a),class:"diagnosis-input",placeholder:"如：头晕、咳嗽、血压高...",rows:"4"},null,8,["modelValue"]),o(_,{class:"diagnosis-actions"},{default:e(()=>[o(g,{class:"voice-btn",onClick:w},{default:e(()=>[o(p,{class:"fas fa-microphone"}),u(" 语音输入 ")]),_:1}),o(g,{class:"img-btn",onClick:x},{default:e(()=>[o(p,{class:"fas fa-image"}),u(" 添加图片 ")]),_:1})]),_:1}),C.value?(t(),s(_,{key:0,class:"img-preview",onClick:z},{default:e(()=>[o(b,{src:C.value,mode:"aspectFit",class:"img-thumb"},null,8,["src"])]),_:1})):i("",!0),o(g,{class:"diagnosis-btn",onClick:T,disabled:y.value},{default:e(()=>[u(f(y.value?"诊断中...":"提交诊断"),1)]),_:1},8,["disabled"]),k.value?(t(),s(_,{key:1,class:"diagnosis-result"},{default:e(()=>[o(p,{class:"result-title"},{default:e(()=>[u("诊断建议：")]),_:1}),o(p,{class:"result-content"},{default:e(()=>[u(f(k.value),1)]),_:1})]),_:1})):i("",!0)]),_:1})]),_:1})}}},[["__scopeId","data-v-abe78679"]]);export{h as default};
