import{r as a,d as s,w as e,e as l,o,f as t,z as i,h as n,j as u,R as c,k as d,S as r,t as f,s as m,T as p,U as v,b as g}from"./index-BVQSbHE9.js";import{r as _}from"./request.BehF0sc9.js";import{_ as h}from"./_plugin-vue_export-helper.BCo6x5W8.js";const b=h({__name:"index",setup(h){const b=a(""),k=a(""),y=a(!1),j=a("");function C(){m({title:"语音输入功能待接入",icon:"none"})}function T(){p({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:a=>{j.value=a.tempFilePaths[0]}})}function x(){v({urls:[j.value]})}function w(){if(!b.value.trim()&&!j.value)return void m({title:"请填写症状或添加图片",icon:"none"});y.value=!0;const a=g("token");console.log("准备发送诊断请求..."),_({url:"/ai/diagnosis",method:"POST",header:{Authorization:"Bearer "+a,"Content-Type":"application/json"},data:{symptoms:b.value,imageUrl:j.value}}).then(a=>{console.log("请求成功:",a),k.value=a.diagnosis||"未获取到诊断建议",y.value=!1}).catch(a=>{console.error("请求失败:",a),m({title:"请求失败",icon:"none"}),y.value=!1})}return(a,m)=>{const p=n,v=c,g=d,_=l,h=r;return o(),s(_,{class:"diagnosis-bg"},{default:e(()=>[t(_,{class:"diagnosis-card"},{default:e(()=>[t(p,{class:"diagnosis-label"},{default:e(()=>[u("请描述您的症状：")]),_:1}),t(p,{class:"diagnosis-tip"},{default:e(()=>[u("可手写输入或语音描述您的身体状况")]),_:1}),t(v,{modelValue:b.value,"onUpdate:modelValue":m[0]||(m[0]=a=>b.value=a),class:"diagnosis-input",placeholder:"如：头晕、咳嗽、血压高...",rows:"4"},null,8,["modelValue"]),t(_,{class:"diagnosis-actions"},{default:e(()=>[t(g,{class:"voice-btn",onClick:C},{default:e(()=>[t(p,{class:"fas fa-microphone"}),u(" 语音输入 ")]),_:1}),t(g,{class:"img-btn",onClick:T},{default:e(()=>[t(p,{class:"fas fa-image"}),u(" 添加图片 ")]),_:1})]),_:1}),j.value?(o(),s(_,{key:0,class:"img-preview",onClick:x},{default:e(()=>[t(h,{src:j.value,mode:"aspectFit",class:"img-thumb"},null,8,["src"])]),_:1})):i("",!0),t(g,{class:"diagnosis-btn",onClick:w,disabled:y.value},{default:e(()=>[u(f(y.value?"诊断中...":"提交诊断"),1)]),_:1},8,["disabled"]),k.value?(o(),s(_,{key:1,class:"diagnosis-result"},{default:e(()=>[t(p,{class:"result-title"},{default:e(()=>[u("诊断建议：")]),_:1}),t(p,{class:"result-content"},{default:e(()=>[u(f(k.value),1)]),_:1})]),_:1})):i("",!0)]),_:1})]),_:1})}}},[["__scopeId","data-v-0ea8c519"]]);export{b as default};
